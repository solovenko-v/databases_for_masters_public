**Контрольная работа №1**  

1. Решить одну из задач пункта _**Joins and Subqueries**_ с сайта [PostgreSQL Exercises](https://www.pgexercises.com)  

1. Решить одну из задач пункта _**Aggregation**_ с сайта [PostgreSQL Exercises](https://www.pgexercises.com)  

1. Решить одну из задач:

   1. Создать в базе данных две таблицы. *Подразделения* и *Сотрудники*. О подразделениях необходимо знать их названия. О сотрудниках - ФИО, подразделение, руководителя (это должен быть другой сотрудник), заработную плату.
   1. Для базы данных созданной в первой задаче составить SQL запрос, выводящий список сотрудников, получающих заработную плату большую чем у непосредственного руководителя  
   **Вариант ответа:** `select a.* from   employee a, employee b where b.id = a.chief_id and a.salary > b.salary`  
   1. Для базы данных созданной в первой задаче составить SQL запрос, выводящий список сотрудников, получающих максимальную заработную плату в своем отделе
   **Вариант ответа:** `select a.* from employee a where a.salary = (select max(salary) from employee b where  b.department_id = a.department_id)` 
   1. Для базы данных созданной в первой задаче составить SQL запрос, выводящий список ID отделов, количество сотрудников в которых не превышает 3 человек
   **Вариант ответа:** `select department_id from employee group  by department_id having count(*) <= 3` 
   1. Для базы данных созданной в первой задаче составить SQL запрос, выводящий список сотрудников, не имеющих назначенного руководителя, работающего в том-же отделе
   **Вариант ответа:** `select a.* from employee a left join employee b on (b.id = a.chief_id and b.department_id = a.department_id)where  b.id is null` 
   1. Для базы данных созданной в первой задаче составить SQL запрос, находящий список ID отделов с максимальной суммарной зарплатой сотрудников
   **Вариант ответа:** `with sum_salary as (select department_id, sum(salary) salary from employee group by department_id) select department_id from sum_salary a where a.salary = (select max(salary) from sum_salary)` 
   1. Найти всех руководителей без руководителей.
   1. Изменить базу данных из первой задачи. Перенести руководителей из таблицы *Сотрудники* в таблицу *Подразделения*.
   1. В условиях задачи 8 составить SQL запрос, выводящий список сотрудников, получающих заработную плату большую чем у непосредственного руководителя
   1. В условиях задачи 8 составить SQL запрос, выводящий список сотрудников, не имеющих назначенного руководителя, работающего в том-же отделе

**Критерии оценки**:

- оценка **«отлично»** выставляется студенту, решившему все три задачи;  
- оценка **«хорошо»** выставляется студенту, решившему 2 задачи;  
- оценка **«удовлетворительно»** выставляется студенту, решившему одну задачу;  
- оценка **«неудовлетворительно»** выставляется студенту, не решившему ни одной задачи.  
